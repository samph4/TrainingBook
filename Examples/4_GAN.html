

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4 - Generative Adversarial Network &#8212; Ai Training Manual for Maisie &amp; Filipe</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-dropdown.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Convolution Filter Example" href="../Extras/Convolutions.html" />
    <link rel="prev" title="3 - LSTM Network" href="3_LSTM.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/EdLogo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Ai Training Manual for Maisie & Filipe</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../Getting%20Started/jupyter%20notebooks.html">
   Jupyter Notebooks
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Python Support
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../Python%20Help/Introduction%20to%20Python.html">
   Introduction to Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Python%20Help/Useful%20Python%20Commands.html">
   Useful Packages / Commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Python%20Help/Glossary.html">
   Glossary
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Machine Learning Examples
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="1_MNIST_MLP.html">
   1 - MNIST MLP Network
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2_MNIST_CNN.html">
   2 - MNIST CNN Network
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3_LSTM.html">
   3 - LSTM Network
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   4 - Generative Adversarial Network
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Extra Stuff
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../Extras/Convolutions.html">
   Convolution Filter Example
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/Examples/4_GAN.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/samph4/TrainingBook"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/samph4/TrainingBook/master?urlpath=tree/Examples/4_GAN.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/samph4/TrainingBook/blob/master/Examples/4_GAN.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preface">
   Preface
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#training-set">
   Training Set
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-libraries">
     Import Libraries
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-training-target-dataset">
     Create Training (Target) Dataset
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#take-real-samples">
       Take Real Samples
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#generate-points-in-latent-space-as-input-for-the-generator">
       Generate points in latent space as input for the generator
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#use-the-generator-to-generate-n-fake-examples-with-class-labels">
       Use the Generator to generate n fake examples, with class labels
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#define-gan-model">
     Define GAN Model
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#discrimnator">
       Discrimnator
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#generator">
       Generator
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#combined-gan-model">
       Combined GAN Model
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#evaluate-performance">
   Evaluate Performance
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="generative-adversarial-network">
<h1>4 - Generative Adversarial Network<a class="headerlink" href="#generative-adversarial-network" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">github.com/samph4</span></code></p>
<p>~</p>
<div class="section" id="preface">
<h2>Preface<a class="headerlink" href="#preface" title="Permalink to this headline">¶</a></h2>
<p>This example will be more in-depth than the first few, but a lot of the principles that we have already applied also apply here. As always, we’ll go through it step by step and I’ll do my best to explain each part so that it makes sense and is as easy to follow as I can make it. In this final example, we will be looking at Generative Adversarial Networks - affectionately known as GANs. The concept of GANs were first introduced by Ian Goodfellow and his team in 2014 (https://arxiv.org/abs/1406.2661), where they “proposed a new framework for estimating generative models via an an adversarial process”. I’ll get into this in much more detail, but essentially what is happening here is that we are going to train two neural networks (that will be adversaries), that will compete against one another in order to improve. One will be reffered to as the Discriminator and the other will be known as the Generator. We combine both of these networks to form a combined model known as the GAN for training. Once training has been completed, we want to be able to use the <em>trained</em> Generator network independently to generate new things!</p>
<p><img alt="Image" src="../_images/gan2.png" /></p>
<p>The image above looks rather unassuming, it is simply a row of portraits of four different people. The interesting thing however, is that none of these people actually exist. They are not real. Each of these images has been generated by a Generative Adversarial Network known as StyleGAN. StyleGAN is a sophisticated GAN that has been curated and trained by NVIDIA and represents the state-of-the-art results in data-driven unconditional generative image modelling and is an impressive testament as to the possibilities of Generative Networks. Here is another video that demonstrates the capabilities of these methods (which is only 2 minutes long so I recommend you watch it because it’s v cool) - https://www.youtube.com/watch?v=p5U4NgVGAwg. With that being said, lets take a closer look as to how these things actually work.</p>
<p><img alt="Image" src="../_images/gan1.png" /></p>
<p>~</p>
</div>
<div class="section" id="training-set">
<h2>Training Set<a class="headerlink" href="#training-set" title="Permalink to this headline">¶</a></h2>
<p>First of all, we need to decide what we want our generative network to generate. Of course, NVIDIA’s sophisticated StyleGAN is capable of generating human faces, but GANs are capable of generating new data regardless of the form that it comes in. GANs can be used to generate new audio signals, new images, new time-series data etc. GANs are capable of generating new data that is representative of the data that it was trained on (the training set). Therefore, in large, a key factor in the success of the GAN model lies in the quality of the training set.</p>
<p>In this example we will</p>
<p><code class="docutils literal notranslate"><span class="pre">dataset</span> <span class="pre">=</span> <span class="pre">name</span> <span class="pre">of</span> <span class="pre">variable</span> <span class="pre">containing</span> <span class="pre">training</span> <span class="pre">set</span></code></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Throughout this example I may use terms such as ‘real’ and ‘fake’ when referring to data. Real refers to data samples that come from the training set and ‘fake’ samples refer to any data that is produced by the Generator.</p>
</div>
<div class="section" id="import-libraries">
<h3>Import Libraries<a class="headerlink" href="#import-libraries" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">randn</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="kn">import</span> <span class="n">LeakyReLU</span>

<span class="kn">from</span> <span class="nn">keras</span> <span class="kn">import</span> <span class="n">optimizers</span>
<span class="kn">from</span> <span class="nn">keras</span> <span class="kn">import</span> <span class="n">initializers</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using TensorFlow backend.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="create-training-target-dataset">
<h3>Create Training (Target) Dataset<a class="headerlink" href="#create-training-target-dataset" title="Permalink to this headline">¶</a></h3>
<p>Here we create a simple dataset that will be used to form the training set of real data. For simplicity, we will consider a simple y=sin(x) function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.23606797749979
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n1</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">dataset</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="n">n1</span><span class="p">)</span>
<span class="n">dataset</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dataset</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dataset</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">dataset</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4_GAN_7_0.png" src="../_images/4_GAN_7_0.png" />
</div>
</div>
<div class="section" id="take-real-samples">
<h4>Take Real Samples<a class="headerlink" href="#take-real-samples" title="Permalink to this headline">¶</a></h4>
<p>To evaluate the performance of the GAN we will use the real data from the training set to train the Discriminator so that it can learn the characteristics of data that comes from the training set. This will make it easier for the Discriminator to label samples that come from the Generator as fake.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">take_real_samples</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="n">idx</span><span class="p">,:]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> 
    
    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="generate-points-in-latent-space-as-input-for-the-generator">
<h4>Generate points in latent space as input for the generator<a class="headerlink" href="#generate-points-in-latent-space-as-input-for-the-generator" title="Permalink to this headline">¶</a></h4>
<p>Next, we can use the generator model to generate fake samples. Although first we need to generate points in latent space via the <code class="docutils literal notranslate"><span class="pre">generate_latent_points()</span></code> function below. These can then be passed to the generator model and used to generate new samples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># generate points in latent space as input for the generator</span>
<span class="k">def</span> <span class="nf">create_latent_points</span><span class="p">(</span><span class="n">latent_dim</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="c1"># generate points in the latent space</span>
    <span class="n">x_input</span> <span class="o">=</span> <span class="n">randn</span><span class="p">(</span><span class="n">latent_dim</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span>
    <span class="c1"># reshape into a batch of inputs for the network</span>
    <span class="n">x_input</span> <span class="o">=</span> <span class="n">x_input</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">latent_dim</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x_input</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="use-the-generator-to-generate-n-fake-examples-with-class-labels">
<h4>Use the Generator to generate n fake examples, with class labels<a class="headerlink" href="#use-the-generator-to-generate-n-fake-examples-with-class-labels" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">generate_fake_samples()</span></code> function below inputs the latent variables created by the <code class="docutils literal notranslate"><span class="pre">generate_latent_points()</span></code> function into the generator network to generate n fake samples <code class="docutils literal notranslate"><span class="pre">X</span></code>. Class labels of 0’s are assigned to variable <code class="docutils literal notranslate"><span class="pre">y</span></code> to label the fake samples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># use the generator to generate n fake examples, with class labels</span>
<span class="k">def</span> <span class="nf">generate_fake_samples</span><span class="p">(</span><span class="n">generator</span><span class="p">,</span> <span class="n">latent_dim</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="c1"># generate points in latent space</span>
    <span class="n">x_input</span> <span class="o">=</span> <span class="n">create_latent_points</span><span class="p">(</span><span class="n">latent_dim</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="c1"># predict outputs</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_input</span><span class="p">)</span>
    <span class="c1"># create class labels</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="define-gan-model">
<h3>Define GAN Model<a class="headerlink" href="#define-gan-model" title="Permalink to this headline">¶</a></h3>
<div class="section" id="discrimnator">
<h4>Discrimnator<a class="headerlink" href="#discrimnator" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">define_discriminator</span><span class="p">(</span><span class="n">n_inputs</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span>  <span class="n">kernel_initializer</span><span class="o">=</span><span class="s1">&#39;he_uniform&#39;</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="n">n_inputs</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">LeakyReLU</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.01</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span>  <span class="n">kernel_initializer</span><span class="o">=</span><span class="s1">&#39;he_uniform&#39;</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">LeakyReLU</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.01</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span>  <span class="n">kernel_initializer</span><span class="o">=</span><span class="s1">&#39;he_uniform&#39;</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">LeakyReLU</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.01</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span>  <span class="n">kernel_initializer</span><span class="o">=</span><span class="s1">&#39;he_uniform&#39;</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">LeakyReLU</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.01</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">))</span>
    <span class="c1"># compile model</span>
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;binary_crossentropy&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">model</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="generator">
<h4>Generator<a class="headerlink" href="#generator" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define the standalone generator model</span>
<span class="k">def</span> <span class="nf">define_generator</span><span class="p">(</span><span class="n">latent_dim</span><span class="p">,</span> <span class="n">n_outputs</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s1">&#39;he_uniform&#39;</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="n">latent_dim</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">n_outputs</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">model</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="combined-gan-model">
<h4>Combined GAN Model<a class="headerlink" href="#combined-gan-model" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define the combined generator and discriminator model, for updating the generator</span>
<span class="k">def</span> <span class="nf">define_gan</span><span class="p">(</span><span class="n">generator</span><span class="p">,</span> <span class="n">discriminator</span><span class="p">):</span>
    <span class="c1"># make weights in the discriminator not trainable</span>
    <span class="n">discriminator</span><span class="o">.</span><span class="n">trainable</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># connect them</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
    <span class="c1"># add generator</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">generator</span><span class="p">)</span>
    <span class="c1"># add the discriminator</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">discriminator</span><span class="p">)</span>
    <span class="c1"># compile model</span>
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;binary_crossentropy&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">model</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="evaluate-performance">
<h2>Evaluate Performance<a class="headerlink" href="#evaluate-performance" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># evaluate the discriminator and plot real and fake points</span>
<span class="k">def</span> <span class="nf">summarize_performance</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="n">generator</span><span class="p">,</span> <span class="n">discriminator</span><span class="p">,</span> <span class="n">latent_dim</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="c1"># prepare real samples</span>
    <span class="n">x_real</span><span class="p">,</span> <span class="n">y_real</span> <span class="o">=</span> <span class="n">take_real_samples</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="c1"># evaluate discriminator on real examples</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">acc_real</span> <span class="o">=</span> <span class="n">discriminator</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x_real</span><span class="p">,</span> <span class="n">y_real</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># prepare fake examples</span>
    <span class="n">x_fake</span><span class="p">,</span> <span class="n">y_fake</span> <span class="o">=</span> <span class="n">generate_fake_samples</span><span class="p">(</span><span class="n">generator</span><span class="p">,</span> <span class="n">latent_dim</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="c1"># evaluate discriminator on fake examples</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">acc_fake</span> <span class="o">=</span> <span class="n">discriminator</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x_fake</span><span class="p">,</span> <span class="n">y_fake</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># summarize discriminator performance</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">acc_real</span><span class="p">,</span> <span class="n">acc_fake</span><span class="p">)</span>
    <span class="c1"># scatter plot real and fake data points</span>
    
    
    <span class="n">pyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_real</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x_real</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_fake</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x_fake</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\u25EF</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># train the generator and discriminator</span>
<span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">g_model</span><span class="p">,</span> <span class="n">d_model</span><span class="p">,</span> <span class="n">gan_model</span><span class="p">,</span> <span class="n">latent_dim</span><span class="p">,</span> <span class="n">n_epochs</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="n">n_batch</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">n_eval</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    <span class="c1"># determine half the size of one batch, for updating the discriminator</span>
    <span class="n">half_batch</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_batch</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="c1"># manually enumerate epochs</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_epochs</span><span class="p">):</span>
        <span class="c1"># prepare real samples</span>
        <span class="n">x_real</span><span class="p">,</span> <span class="n">y_real</span> <span class="o">=</span> <span class="n">take_real_samples</span><span class="p">(</span><span class="n">half_batch</span><span class="p">)</span>
        <span class="c1"># prepare fake examples</span>
        <span class="n">x_fake</span><span class="p">,</span> <span class="n">y_fake</span> <span class="o">=</span> <span class="n">generate_fake_samples</span><span class="p">(</span><span class="n">g_model</span><span class="p">,</span> <span class="n">latent_dim</span><span class="p">,</span> <span class="n">half_batch</span><span class="p">)</span>
        <span class="c1"># update discriminator</span>
        <span class="n">d_model</span><span class="o">.</span><span class="n">train_on_batch</span><span class="p">(</span><span class="n">x_real</span><span class="p">,</span> <span class="n">y_real</span><span class="p">)</span>
        <span class="n">d_model</span><span class="o">.</span><span class="n">train_on_batch</span><span class="p">(</span><span class="n">x_fake</span><span class="p">,</span> <span class="n">y_fake</span><span class="p">)</span>
        <span class="c1"># prepare points in latent space as input for the generator</span>
        <span class="n">x_gan</span> <span class="o">=</span> <span class="n">create_latent_points</span><span class="p">(</span><span class="n">latent_dim</span><span class="p">,</span> <span class="n">n_batch</span><span class="p">)</span>
        <span class="c1"># create inverted labels for the fake samples</span>
        <span class="n">y_gan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n_batch</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="c1"># update the generator via the discriminator&#39;s error</span>
        <span class="n">gan_model</span><span class="o">.</span><span class="n">train_on_batch</span><span class="p">(</span><span class="n">x_gan</span><span class="p">,</span> <span class="n">y_gan</span><span class="p">)</span>
        <span class="c1"># evaluate the model every n_eval epochs</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n_eval</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">summarize_performance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">g_model</span><span class="p">,</span> <span class="n">d_model</span><span class="p">,</span> <span class="n">latent_dim</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># size of the latent space</span>
<span class="n">latent_dim</span> <span class="o">=</span> <span class="mi">5</span>
<span class="c1"># create the discriminator</span>
<span class="n">discriminator</span> <span class="o">=</span> <span class="n">define_discriminator</span><span class="p">()</span>
<span class="c1"># create the generator</span>
<span class="n">generator</span> <span class="o">=</span> <span class="n">define_generator</span><span class="p">(</span><span class="n">latent_dim</span><span class="p">)</span>
<span class="c1"># create the gan</span>
<span class="n">gan_model</span> <span class="o">=</span> <span class="n">define_gan</span><span class="p">(</span><span class="n">generator</span><span class="p">,</span> <span class="n">discriminator</span><span class="p">)</span>
<span class="c1"># train model</span>
<span class="n">train</span><span class="p">(</span><span class="n">generator</span><span class="p">,</span> <span class="n">discriminator</span><span class="p">,</span> <span class="n">gan_model</span><span class="p">,</span> <span class="n">latent_dim</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">InternalError</span><span class="g g-Whitespace">                             </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">3</span><span class="n">db7c9b9c7df</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">gan_model</span> <span class="o">=</span> <span class="n">define_gan</span><span class="p">(</span><span class="n">generator</span><span class="p">,</span> <span class="n">discriminator</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="c1"># train model</span>
<span class="ne">---&gt; </span><span class="mi">10</span> <span class="n">train</span><span class="p">(</span><span class="n">generator</span><span class="p">,</span> <span class="n">discriminator</span><span class="p">,</span> <span class="n">gan_model</span><span class="p">,</span> <span class="n">latent_dim</span><span class="p">)</span>

<span class="nn">&lt;ipython-input-11-21e0732ec1cf&gt;</span> in <span class="ni">train</span><span class="nt">(g_model, d_model, gan_model, latent_dim, n_epochs, n_batch, n_eval)</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span>         <span class="n">x_real</span><span class="p">,</span> <span class="n">y_real</span> <span class="o">=</span> <span class="n">take_real_samples</span><span class="p">(</span><span class="n">half_batch</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span>         <span class="c1"># prepare fake examples</span>
<span class="ne">---&gt; </span><span class="mi">10</span>         <span class="n">x_fake</span><span class="p">,</span> <span class="n">y_fake</span> <span class="o">=</span> <span class="n">generate_fake_samples</span><span class="p">(</span><span class="n">g_model</span><span class="p">,</span> <span class="n">latent_dim</span><span class="p">,</span> <span class="n">half_batch</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span>         <span class="c1"># update discriminator</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span>         <span class="n">d_model</span><span class="o">.</span><span class="n">train_on_batch</span><span class="p">(</span><span class="n">x_real</span><span class="p">,</span> <span class="n">y_real</span><span class="p">)</span>

<span class="nn">&lt;ipython-input-6-09e284b18cef&gt;</span> in <span class="ni">generate_fake_samples</span><span class="nt">(generator, latent_dim, n)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="n">x_input</span> <span class="o">=</span> <span class="n">create_latent_points</span><span class="p">(</span><span class="n">latent_dim</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>     <span class="c1"># predict outputs</span>
<span class="ne">----&gt; </span><span class="mi">6</span>     <span class="n">X</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_input</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>     <span class="c1"># create class labels</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span>     <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="nn">~\miniconda3\envs\tensorflow\lib\site-packages\keras\engine\training.py</span> in <span class="ni">predict</span><span class="nt">(self, x, batch_size, verbose, steps, callbacks, max_queue_size, workers, use_multiprocessing)</span>
<span class="g g-Whitespace">   </span><span class="mi">1460</span>                                             <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1461</span>                                             <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
<span class="ne">-&gt; </span><span class="mi">1462</span>                                             <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1463</span> 
<span class="g g-Whitespace">   </span><span class="mi">1464</span>     <span class="k">def</span> <span class="nf">train_on_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>

<span class="nn">~\miniconda3\envs\tensorflow\lib\site-packages\keras\engine\training_arrays.py</span> in <span class="ni">predict_loop</span><span class="nt">(model, f, ins, batch_size, verbose, steps, callbacks)</span>
<span class="g g-Whitespace">    </span><span class="mi">322</span>             <span class="n">batch_logs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;batch&#39;</span><span class="p">:</span> <span class="n">batch_index</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">batch_ids</span><span class="p">)}</span>
<span class="g g-Whitespace">    </span><span class="mi">323</span>             <span class="n">callbacks</span><span class="o">.</span><span class="n">_call_batch_hook</span><span class="p">(</span><span class="s1">&#39;predict&#39;</span><span class="p">,</span> <span class="s1">&#39;begin&#39;</span><span class="p">,</span> <span class="n">batch_index</span><span class="p">,</span> <span class="n">batch_logs</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">324</span>             <span class="n">batch_outs</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">ins_batch</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">325</span>             <span class="n">batch_outs</span> <span class="o">=</span> <span class="n">to_list</span><span class="p">(</span><span class="n">batch_outs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">326</span>             <span class="k">if</span> <span class="n">batch_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

<span class="nn">~\miniconda3\envs\tensorflow\lib\site-packages\tensorflow_core\python\keras\backend.py</span> in <span class="ni">__call__</span><span class="nt">(self, inputs)</span>
<span class="g g-Whitespace">   </span><span class="mi">3725</span>         <span class="n">value</span> <span class="o">=</span> <span class="n">math_ops</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">tensor</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3726</span>       <span class="n">converted_inputs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3727</span>     <span class="n">outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_graph_fn</span><span class="p">(</span><span class="o">*</span><span class="n">converted_inputs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3728</span> 
<span class="g g-Whitespace">   </span><span class="mi">3729</span>     <span class="c1"># EagerTensor.numpy() will often make a copy to ensure memory safety.</span>

<span class="nn">~\miniconda3\envs\tensorflow\lib\site-packages\tensorflow_core\python\eager\function.py</span> in <span class="ni">__call__</span><span class="nt">(self, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1549</span>       <span class="ne">TypeError</span><span class="p">:</span> <span class="n">For</span> <span class="n">invalid</span> <span class="n">positional</span><span class="o">/</span><span class="n">keyword</span> <span class="n">argument</span> <span class="n">combinations</span><span class="o">.</span>
<span class="g g-Whitespace">   </span><span class="mi">1550</span>     <span class="s2">&quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1551</span><span class="s2">     return self._call_impl(args, kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1552</span><span class="s2"> </span>
<span class="g g-Whitespace">   </span><span class="mi">1553</span><span class="s2">   def _call_impl(self, args, kwargs, cancellation_manager=None):</span>

<span class="nn">~\miniconda3\envs\tensorflow\lib\site-packages\tensorflow_core\python\eager\function.py</span> in <span class="ni">_call_impl</span><span class="nt">(self, args, kwargs, cancellation_manager)</span>
<span class="g g-Whitespace">   </span><span class="mi">1589</span><span class="s2">       raise TypeError(&quot;Keyword arguments </span><span class="si">{}</span><span class="s2"> unknown. Expected </span><span class="si">{}</span><span class="s2">.&quot;.format(</span>
<span class="g g-Whitespace">   </span><span class="mi">1590</span><span class="s2">           list(kwargs.keys()), list(self._arg_keywords)))</span>
<span class="ne">-&gt; </span><span class="mi">1591</span><span class="s2">     return self._call_flat(args, self.captured_inputs, cancellation_manager)</span>
<span class="g g-Whitespace">   </span><span class="mi">1592</span><span class="s2"> </span>
<span class="g g-Whitespace">   </span><span class="mi">1593</span><span class="s2">   def _filtered_call(self, args, kwargs):</span>

<span class="nn">~\miniconda3\envs\tensorflow\lib\site-packages\tensorflow_core\python\eager\function.py</span> in <span class="ni">_call_flat</span><span class="nt">(self, args, captured_inputs, cancellation_manager)</span>
<span class="g g-Whitespace">   </span><span class="mi">1690</span><span class="s2">       # No tape is watching; skip to running the function.</span>
<span class="g g-Whitespace">   </span><span class="mi">1691</span><span class="s2">       return self._build_call_outputs(self._inference_function.call(</span>
<span class="ne">-&gt; </span><span class="mi">1692</span><span class="s2">           ctx, args, cancellation_manager=cancellation_manager))</span>
<span class="g g-Whitespace">   </span><span class="mi">1693</span><span class="s2">     forward_backward = self._select_forward_and_backward_functions(</span>
<span class="g g-Whitespace">   </span><span class="mi">1694</span><span class="s2">         args,</span>

<span class="nn">~\miniconda3\envs\tensorflow\lib\site-packages\tensorflow_core\python\eager\function.py</span> in <span class="ni">call</span><span class="nt">(self, ctx, args, cancellation_manager)</span>
<span class="g g-Whitespace">    </span><span class="mi">543</span><span class="s2">               inputs=args,</span>
<span class="g g-Whitespace">    </span><span class="mi">544</span><span class="s2">               attrs=(&quot;executor_type&quot;, executor_type, &quot;config_proto&quot;, config),</span>
<span class="ne">--&gt; </span><span class="mi">545</span><span class="s2">               ctx=ctx)</span>
<span class="g g-Whitespace">    </span><span class="mi">546</span><span class="s2">         else:</span>
<span class="g g-Whitespace">    </span><span class="mi">547</span><span class="s2">           outputs = execute.execute_with_cancellation(</span>

<span class="nn">~\miniconda3\envs\tensorflow\lib\site-packages\tensorflow_core\python\eager\execute.py</span> in <span class="ni">quick_execute</span><span class="nt">(op_name, num_outputs, inputs, attrs, ctx, name)</span>
<span class="g g-Whitespace">     </span><span class="mi">65</span><span class="s2">     else:</span>
<span class="g g-Whitespace">     </span><span class="mi">66</span><span class="s2">       message = e.message</span>
<span class="ne">---&gt; </span><span class="mi">67</span><span class="s2">     six.raise_from(core._status_to_exception(e.code, message), None)</span>
<span class="g g-Whitespace">     </span><span class="mi">68</span><span class="s2">   except TypeError as e:</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span><span class="s2">     keras_symbolic_tensors = [</span>

<span class="nn">~\miniconda3\envs\tensorflow\lib\site-packages\six.py</span> in <span class="ni">raise_from</span><span class="nt">(value, from_value)</span>

<span class="ne">InternalError</span>:  Blas GEMM launch failed : a.shape=(32, 5), b.shape=(5, 15), m=32, n=15, k=5
<span class="s2">	 [[node dense_6/MatMul (defined at C:\Users\Samuel\miniconda3\envs</span><span class="se">\t</span><span class="s2">ensorflow\lib\site-packages\keras</span><span class="se">\b</span><span class="s2">ackend</span><span class="se">\t</span><span class="s2">ensorflow_backend.py:3009) ]] [Op:__inference_keras_scratch_graph_377]</span>

<span class="s2">Function call stack:</span>
<span class="s2">keras_scratch_graph</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "tensorflow"
        },
        kernelOptions: {
            kernelName: "tensorflow",
            path: "./Examples"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'tensorflow'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="3_LSTM.html" title="previous page">3 - LSTM Network</a>
    <a class='right-next' id="next-link" href="../Extras/Convolutions.html" title="next page">Convolution Filter Example</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Samuel Thompson<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>